server {
        listen       80;
        server_name  ap-coupon.pre.dface.cn;

        client_header_buffer_size 4k;
        send_timeout 120;
        fastcgi_intercept_errors on;

        client_max_body_size 10m;
        proxy_connect_timeout         120s;
        proxy_read_timeout            2m;
        proxy_send_timeout            2m;
        client_body_timeout           2m;
        root /home/lian/webapp/ap_coupon/;

        location ^~ /api/  {
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Real-IP       $remote_addr;
            proxy_set_header Host $http_host;
            proxy_pass http://172.20.1.19:30080;
           proxy_redirect default;
        }



        error_page  404              /index.html;
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
}



    server {
        listen      80;
        server_name   ap-coupon.pre.dface.cn;

        client_header_buffer_size 8k;
        client_max_body_size 40m;
        send_timeout 120;
        fastcgi_read_timeout 300;
        fastcgi_send_timeout 300;
        fastcgi_connect_timeout 300;
        fastcgi_intercept_errors on;

        root html;


        location ^~ /api/ {
            root html;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Real-IP       $remote_addr;
            proxy_set_header Host $http_host;

            proxy_pass http://aone_server;
            proxy_redirect default;
        }

        location /  {
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Real-IP       $remote_addr;
            proxy_set_header Host $http_host;
            proxy_pass http://wx_coupon23.java.dface.cn/;
           proxy_redirect default;
        }

    }